<% layout("/layouts/dialog", {
	styles: ["user/accessCode"],
	scripts: ["user/accessCode"]
}) %>
<h1>
	<i>password</i>
	Kod dostępu
</h1>
<main>
	<% function accessCodeContainer(code) { %>
		<%~ include("/templates/qrCode", {
			data: `https://${Config.host}/login?code=${code.replaceAll(" ", "")}`
		}) %>
		<div class="access-code-container" onclick="copy(this.children[0])">
			<p class="access-code"><%= code %></p>
			<p>Naciśnij aby skopiować</p>
		</div>
	<% } %>

	<% if(!$.parentCode) { %>
		<h2><%= $.targetUser.displayName %></h2>
		<article><p><i>info</i> Kod ważny przez 5 minut</p></article>
		<% if($.targetUser.id != $.user.id) { %>
			<% if(!$.targetUser.isParent) { %>
				<p class="warning">
					<i>warning</i>
					Poniższy kod dostępu umożliwi dostęp do konta <%= $.targetUser.displayName %>, <b>nie konta rodzica/opiekuna</b>!
				</p>
			<% } %>
			<article><p><i>info</i> Kod ważny przez 5 minut</p></article>
			<p>Jednorazowy kod dostępu dla użytkownika <%= $.targetUser.displayName %>:</p>
		<% } %>
		<% accessCodeContainer($.targetUser.auth.formattedAccessCode) %>
	<% } else { %>
		<% $.targetUser.defaultName = "Rodzic / opiekun" %>
		<h2><%= $.targetUser.displayName %></h2>
		<article><p><i>info</i> Kod ważny przez 5 minut</p></article>
		<p>Jednorazowy kod dostępu dla konta rodzica / opiekuna:</p>
		<% accessCodeContainer($.targetUser.parents[0].auth.formattedAccessCode) %>
	<% } %>
</main>
<hr>
<div class="button-row">
	<button onclick="dialog.close()">
		<i>arrow_back</i>
		Zamknij
	</button>
</div>