<% layout("/layouts/dialog", {
	scripts: ["unit/setRole"],
	meta: {
		unitID: $.targetUnit.id
	}
}) %>
<h1>
	<i>add_moderator</i>
	Mianowanie na funkcję
</h1>
<main>
	<% if($.usersForAssignment.length) { %>
		<h2>Wybierz funkcję</h2>
		<form id="role-select">
			<% for(const roleID of $.targetUnit.config.roles || []) { %>
				<% const role = Config.roles[roleID] %>
				<input
					type="radio"
					name="roleType"
					value="<%= roleID %>"
					id="role-<%= roleID %>"
					data-name-variants="<%= JSON.stringify(role.name) %>"
				>
				<label for="role-<%= roleID %>"><%= role.name[$.orgContext] || role.name[$.targetUnit.org] || role.name["default"] %></label>
			<% } %>
			<input type="radio" name="roleType" value="remove" id="role-remove">
			<label for="role-remove">Usuń z jednostki</label>
		</form>
			
		<h2>Wybierz użytkownika</h2>
		<form id="user-select">
			<% function listUsers(users) { %>
				<% for(const member of users) { %>
					<input type="radio" name="memberID" value="<%= member.id %>" id="user-<%= member.id %>" data-org="<%= member.org %>">
					<label for="user-<%= member.id %>"><%= member.displayName %></label>
				<% } %>
			<% } %>
			<%
				if($.orgContext) listUsers($.usersForAssignment.filter(u => u.org == $.orgContext))
				else listUsers($.usersForAssignment)
			%>
		</form>
	<% } else { %>
		<p>Brak użytkowników do mianowania</p>
	<% } %>
</main>
<hr>
<div class="button-row">
	<button onclick="dialog.close()">
		<i>arrow_back</i>
		Anuluj
	</button>
	<% if($.usersForAssignment.length) { %>
		<button id="set-role-button" api="unit/[unitID]/member/[memberID]/setRole">
			<i>check</i>
			<span>Potwierdź mianowanie</span>
		</button>
	<% } %>
</div>