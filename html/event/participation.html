<% layout("/layouts/dialog", {
	scripts: ["signature", "event/participation"],
	styles: ["signature"],
	meta: {
		eventID: $.targetEvent.id
	}
}) %>
<h1>
	Uczestnictwo w <%= $.targetEvent.displayName %>
</h1>
<main>
	<% if($.targetInvitation.user.id != $.user.id) { %>
		<h2><%= $.targetInvitation.user.displayName %></h2>
	<% } %>
	<% let canParticipate = true %>
	<% if(!$.targetInvitation.user.confirmed) { %>
		<% canParticipate = false %>
		<p class="warning"><%~ icon`warning` %> Zatwierdź dane <a href="/users/<%= $.targetInvitation.user.id %>">na profilu uczestnika</a>, aby potwierdzić udział w akcji.</p>
	<% } %>
	<% if(canParticipate) { %>
		<section>
			<form>
				<input type="radio" name="participation" id="participation-choice-yes" value="yes"
					<%= $.targetInvitation.state == "accepted" ? "checked" : "" %>
				>
				<label for="participation-choice-yes">
					<% if($.targetInvitation.user.id == $.user.id) { %>
						Wezmę
					<% } else { %>
						<%= $.targetInvitation.user.name.first %> weźmie
					<% } %>
					udział
				</label>
				<input type="radio" name="participation" id="participation-choice-no" value="no"
					<%= $.targetInvitation.state == "declined" ? "checked" : "" %>
				>
				<label for="participation-choice-no">
					<% if($.targetInvitation.user.id == $.user.id) { %>
						Nie wezmę
					<% } else { %>
						<%= $.targetInvitation.user.name.first %> nie weźmie
					<% } %>
					udziału
				</label>
			</form>
		</section>
		<article id="participation-text">
			<p>
				Podpisując się poniżej, udzielasz zgody na udział <%= $.targetInvitation.user.displayName %> w akcji <%= $.targetEvent.displayName %>. W przypadku rezygnacji z udziału, zobowiązujesz się do zmienienia swojego wyboru powyżej.
			</p>
			<p>
				Oświadczasz, że wszystkie dane na profilu <a href="/users/<%= $.targetInvitation.user.id %>"><%= $.targetInvitation.user.displayName %></a> (w tym dane kontaktowe i wymagania medyczne/dietetyczne) są poprawne i aktualne. Jeśli danę ulegną zmianie, zobowiązujesz się do niezwłocznego zaktualizowania ich na profilu uczestnika. Wyrażasz zgodę na dostęp do tych danych dla organizatorów akcji, w celach zapewnienia bezpieczeństwa.
			</p>
		</article>
		<%~ include("/templates/signature", {
			user: $.user
		}) %>
		<button class="confirm" api="event/[eventID]/member/<%= $.targetInvitation.user.id %>/setParticipation">
			<%~ icon`check` %>
			Potwierdź
		</button>
	<% } %>
</main>
<div class="button-row">
	<button>
		<%~ icon`arrow_back` %>
		Anuluj
	</button>
</div>