<% layout("/layouts/dialog", {
	scripts: ["event/participation"],
	meta: {
		eventID: $.targetEvent.id
	}
}) %>
<h1>
	Uczestnictwo w <%= $.targetEvent.displayName %>
</h1>
<main>
	<% if($.targetInvitation.user.id != $.user.id) { %>
		<p><%= $.targetInvitation.user.displayName %></p>
	<% } %>
	<% let canParticipate = true %>
	<% if(!$.targetInvitation.user.profileComplete) { %>
		<% canParticipate = false %>
		<p class="warning"><i>warning</i> Uzupełnij dane na profilu uczestnika, aby móc potwierdzić udział w akcji.</p>
	<% } %>
	<% if($.targetInvitation.user.parents.length > 0 && $.targetInvitation.user.parents.every(p => !p.profileComplete)) { %>
		<% canParticipate = false %>
		<p class="warning"><i>warning</i> Uzupełnij dane na profilu rodzica uczestnika, aby móc potwierdzić udział w akcji.</p>
	<% } %>
	<% if(canParticipate) { %>
		<form id="event-participation">
			<input type="radio" name="participation" id="participation-choice-yes" value="yes"
				<%= $.targetInvitation.state == "accepted" ? "checked" : "" %>
			>
			<label for="participation-choice-yes">
				<% if($.targetInvitation.user.id == $.user.id) { %>
					Wezmę
				<% } else { %>
					<%= $.targetInvitation.user.name.first %> weźmie
				<% } %>
				udział
			</label>
			<input type="radio" name="participation" id="participation-choice-no" value="no"
				<%= $.targetInvitation.state == "declined" ? "checked" : "" %>
			>
			<label for="participation-choice-no">
				<% if($.targetInvitation.user.id == $.user.id) { %>
					Nie wezmę
				<% } else { %>
					<%= $.targetInvitation.user.name.first %> nie weźmie
				<% } %>
				udziału
			</label>
		</form>
		<form>
			<input type="checkbox" disabled>
			<label for="signature">Podpis</label>
		</form>
		<button class="confirm" api="event/[eventID]/member/<%= $.targetInvitation.user.id %>/setParticipation">
			<i>check</i>
			<span>Potwierdź</span>
		</button>
	<% } %>
</main>
<div class="button-row">
	<button onclick="dialog.close()">
		<i>arrow_back</i>
		<span>Anuluj</span>
	</button>
</div>